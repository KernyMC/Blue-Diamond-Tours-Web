---
import { Icon } from "astro-icon/components";

interface Props {
    size?: "small" | "medium" | "large";
    numero: string;
    mensaje?: string;
}

const { size = "medium", numero, mensaje = "Hola, me gustaría más información" } = Astro.props;

// Limpiar el número (quitar espacios, guiones, etc)
const numeroLimpio = numero.replace(/\s+/g, "").replace(/-/g, "");

// Construir URL de WhatsApp
const whatsappUrl = `https://wa.me/${numeroLimpio}?text=${encodeURIComponent(mensaje)}`;

// Definir tamaños responsive (mobile siempre small, desktop según prop)
const sizeClasses = {
    small: "w-12 h-12 md:w-12 md:h-12",
    medium: "w-12 h-12 md:w-16 md:h-16",
    large: "w-12 h-12 md:w-20 md:h-20"
};

const bottomPositions = {
    small: "bottom-4 md:bottom-4",
    medium: "bottom-4 md:bottom-6",
    large: "bottom-4 md:bottom-8"
};

const rightPositions = {
    small: "right-4 md:right-4",
    medium: "right-4 md:right-6",
    large: "right-4 md:right-8"
};
---

<a
    href={whatsappUrl}
    target="_blank"
    rel="noopener noreferrer"
    class={`fixed ${bottomPositions[size]} ${rightPositions[size]} ${sizeClasses[size]} bg-[#25D366] hover:bg-[#1ebc59] text-white rounded-full flex items-center justify-center shadow-2xl hover:shadow-[0_0_30px_rgba(37,211,102,0.5)] transition-all duration-300 hover:scale-110 z-50 group`}
    aria-label="Contactar por WhatsApp"
>
    <Icon name="ant-design:whats-app-outlined" class="w-6 h-6 md:w-8 md:h-8" />
    
    <!-- Animación de pulso -->
    <span class="absolute inset-0 rounded-full bg-[#25D366] animate-ping opacity-20"></span>
</a>

<style>
    @keyframes ping {
        75%, 100% {
            transform: scale(1.2);
            opacity: 0;
        }
    }
    
    .animate-ping {
        animation: ping 2s cubic-bezier(0, 0, 0.2, 1) infinite;
    }
</style>
